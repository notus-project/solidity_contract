// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import {Test, console2} from "forge-std/Test.sol";
import {Verifier} from "../src/Verifier.sol";

contract CounterTest is Test {
    Verifier public verifier;

    function setUp() public {
        verifier = new Verifier();
    }

    function test_VerifyProof() public {
        uint256[2] memory a = [
            17241290723196475852476431930730689472563037306246795852381340887522496979820,
            7676305066324681685622810250862354688404848905083996862506946690157199357723
        ];
        uint256[2][2] memory b = [
            [
                16998342148863368913618509636633340706778073273314963196660929570532967316401,
                9013095509415369598283180576503134360394555780496488345465434710145952322316
            ],
            [
                10783014201305970719583707144793620455117401442448380965995330128311320748386,
                8679675753320963018637879952651878716324126237623844307825745462070533875528
            ]
        ];
        uint256[2] memory c = [
            4703056848035128147945123027285656588833405255399212575047833647556461701877,
            1349366126997526735900487755803139506854304387767597036756729009383860669
        ];
        uint256[7] memory input = [
            uint256(
                162732464387582717570123017626387053973207365964039744056164982922372311
            ),
            uint256(
                232053033715262687057565978467259454046661082426121624614059644409858163
            ),
            uint256(
                81822502605592584835052160880302118605194969882708723674837149949595342
            ),
            uint256(
                75226133571287210008390538199432240295617554087149052494335837531990239
            ),
            uint256(1000000),
            uint256(
                36484854600246113238697725883828891931804413955777599306915050035854432
            ),
            uint256(
                201002266038091640628570670555076717536618645126001394631820006205192160
            )
        ];

        assertEq(verifier.verifyProof(a, b, c, input), true);
    }

    function test_VerifyExp1() public {
        bytes
            memory q = hex"519a6f9e880e8af0329c1a73cd2fd1a8f73f49e0d088fccc5869712bc061802bde62135b9993a9ce547bd36af7d3ea71e4a41b28d9366538850237075790ffeecfc0a2860e698ef3fd2ba949150835014134fde77d34fcc3992c0338ee02eb9e2f72918a01c586d58a60df68e830cc9bc66c888eed671aee5e887c3c10442ef57cd948d92cb2da705bef15a31691d01f308c5f372fb2125b6549a018131cc907d87dce4ba0ab3f8a9b27adb7f5c86c93a0f4133e89fcd93bb127d2943f96c53d3d6a955370a2cc9a3ec71327c0c609477ce7ce2427b5f5012adf5cbd0e08234c1bb0d204e8dd56bae7a81068fcca042326eb4749989908194c824f02c9f9b0c1";
        bytes
            memory l = hex"a644042393a66546916e1ef8baa2f6c8a23a000eadf7619b6e31fd091cba9ea9";
        bytes
            memory g = hex"1d94de4e254c37469dc4984234034e3418bc2817b27e8e34931576e87905b5dca4802726251c89b126f8e20017bf960ad744103595641d931cdf82b039473a3c5b84122ffdb630d01e90c33405ecb52a4b761c1fcd4e0b46136868aaca92a3bd7d4efb97f416f228a70a94c57f598c236b4aef72ed446ec9b0b388475a420a6abd7616dffcb14363b4560662edf523acfc393a63f45d2aa6a93bb048cacd0f9e937966d19afc5c9985a13ecfb77a0bba69ee261ed2c0b306565b009d0d2e7669ff565c8e82e0ae1591f27003f38590289dfd82819a51f00d3458aa564fabf4467a2f01fc0c8ac04cf0f37a80afd9e5174cd1798bbf7edc9e88b471cba68c68b9";
        bytes
            memory r = hex"1663ef6200f68538718b9b0f0ff236aa6cdc541e8f2712e27277ddc054b74763";
        bytes
            memory acc = hex"68e38e73baee752194862181e81d2e5e71b9db94432de3487d1806f0e0a85b05018afa09a22ccbbfa4885c537e7bcb169cadd559fed1f628aa196e35b0f3c022b73270aa559b2cb39ade75122cfc6ee35dfdd64e56080912f59c3e0869c226e2d89d22044e27e1ed1f0d6b0df06d76ca03adc3f3d956d04da3884f2f28eb25d2545499da3f880dacf99aba25efe4d8171d75b8ae682765b9ae47fd0cc88ba8c73b14d377915d38c78c0bf0b3ad655e85d8efdc687647010bc96bcddbed0326e11acce8eba7e8a90a25edda5cd8c79b7ce3c8423b28826a3420dcfa1d3e46639c5091684d719caabf9ac1f2a253ee904363d215e8f3bdc2b4810939c0a00fd35f";
        bytes
            memory n = hex"b2e351a825bc814f6b60e88f53b6d67e82e94bb78feb9dfa9b43f5471f282c0d73872207fbd4823d18deb5e61e2791acd7c3e8099f9dcdf60097712546c558b2c008376d3a6ed69713ad0b0b38246f0e5b929a1c0bae43f91dff2f7c675739c12bb2b77ee80ef0e8d3313552df6500c7f2c6ea3213c150842a6154b64684a5f8d66ba871e2f77c9d1593a21416b8190f8c285df5435895e5d7026e4c0ed890d4f6e1ae4dda43ebe0b231d6a96b04e52aee6d7c75e60439ecff30695d1a218e6402853d6529cb70bb9c6cea0cee37459c0fc06ba482eb3b6508f12996386be90896c84dd24ee62e9c0da6284f4b25c48aeca18754eefaea1954c5506d68866e71";

        assertEq(verifier.verifyExp(q, l, g, r, acc, n), true);
    }

    function test_VerifyExp2() public {
        bytes
            memory q = hex"2d4a8b63c9f4013651647ef4533087f93574adbb9278e756ba391ef182e1e851f82281d57286f07d5fbb323d6fb34726926ecbcce01f508e976fd1f003cadb38354057e6ac4df2e28b4cf62ffa2fdb215b1ae214d486917a3469f2a23346c3152b3c6753261c7f8cc0035c146824f79cafc6a8cee6bfadffdd32ff212793390316f984854872910ee00b7a22e328318058bfa77600362643055de013c85510fec6ead3b0ef6ec07bde5228c7b999d509ebdb757ad1351f3ce79a9b2d9d56066d7fa5f2a1de7d31a934b81d229adc70bcb2a4b219e7788cbc0b3adc3de483a79cc3e4a56363102c49c7dfbe84931a08c38337b15a846808bb7e83ec77cf5e08bb";
        bytes
            memory l = hex"9de8e44b5979da39123d2e54e73e383611b8f3eb559e32da79800a38ca5f5d59";
        bytes
            memory g = hex"1d94de4e254c37469dc4984234034e3418bc2817b27e8e34931576e87905b5dca4802726251c89b126f8e20017bf960ad744103595641d931cdf82b039473a3c5b84122ffdb630d01e90c33405ecb52a4b761c1fcd4e0b46136868aaca92a3bd7d4efb97f416f228a70a94c57f598c236b4aef72ed446ec9b0b388475a420a6abd7616dffcb14363b4560662edf523acfc393a63f45d2aa6a93bb048cacd0f9e937966d19afc5c9985a13ecfb77a0bba69ee261ed2c0b306565b009d0d2e7669ff565c8e82e0ae1591f27003f38590289dfd82819a51f00d3458aa564fabf4467a2f01fc0c8ac04cf0f37a80afd9e5174cd1798bbf7edc9e88b471cba68c68b9";
        bytes
            memory r = hex"4315671e0602811870b5aee111d2be14b5a2c76581152c2335a66384ec6b426c";
        bytes
            memory acc = hex"73ac7adb9e995bb11fbf41256de587f796fac0c0f296e8d2ee6e5dbc1bc312693ed63786ae5b555885c900bbeda3bf0f17b223798d63fd227dbe2fdb0c28c7cb1e6c43a7773316fc5822ddb37306344a883209c2e3e9807e60daf9e8cea6b362d27991e4116bb45a9531cba30b2cc55b94d7281f58a1cdd8640107fa4b22384857fa76cd2a791c9395e39aecef050a7d857c4e1bd628931f6c0dabd3ad05cd72ca038089ef050006e682583f1ce1590984da29f396a6540cff910a5dd71820a54cbc73981d6d8ac057c309ca6077ea4ec12b3464998bce0f2b531a25854ee84ac369dba8c16630b0eecff6e79ae34f480f4a592e9db8d10fe25ea2cc9d9567b9";
        bytes
            memory n = hex"b2e351a825bc814f6b60e88f53b6d67e82e94bb78feb9dfa9b43f5471f282c0d73872207fbd4823d18deb5e61e2791acd7c3e8099f9dcdf60097712546c558b2c008376d3a6ed69713ad0b0b38246f0e5b929a1c0bae43f91dff2f7c675739c12bb2b77ee80ef0e8d3313552df6500c7f2c6ea3213c150842a6154b64684a5f8d66ba871e2f77c9d1593a21416b8190f8c285df5435895e5d7026e4c0ed890d4f6e1ae4dda43ebe0b231d6a96b04e52aee6d7c75e60439ecff30695d1a218e6402853d6529cb70bb9c6cea0cee37459c0fc06ba482eb3b6508f12996386be90896c84dd24ee62e9c0da6284f4b25c48aeca18754eefaea1954c5506d68866e71";

        assertEq(verifier.verifyExp(q, l, g, r, acc, n), true);
    }
}
